---
import ProfileLayout from '@layouts/ProfileLayout.astro';
import HeroSection from '@components/landing/HeroSection.astro';
import ProjectCard from '@components/landing/ProjectCard.astro';
import SkillsSection from '@components/landing/SkillsSection.astro';
import ExperienceTimeline from '@components/landing/ExperienceTimeline.astro';
import CTASection from '@components/landing/CTASection.astro';
import { profiles } from '@data/profiles';
import { SITE_CONFIG } from '@data/config';
import { getProjectsByProfile } from '@data/projects';
import { getLanguagePaths } from '@utils/i18n-paths';
import { 
  type Lang, 
  useTranslations, 
  type CommonTranslations, 
  type ProfileTranslations 
} from '@i18n/index';

export const getStaticPaths = getLanguagePaths;

const { lang } = Astro.params as { lang: Lang };
const profile = profiles.developer;
const projects = getProjectsByProfile('developer', true);
const t = await useTranslations<CommonTranslations>(lang, 'common');
const content = await useTranslations<ProfileTranslations>(lang, 'developer');

// Transform experience data for the component
const experiences = [
  { role: content.experience.role1, company: content.experience.company1, items: content.experience.items1 },
  { role: content.experience.role2, company: content.experience.company2, items: content.experience.items2 },
];

// CTA buttons configuration
const ctaButtons = [
  { text: t.cta.contact, href: '#', icon: 'fas fa-envelope', primary: true, isContactTrigger: true },
  { text: t.cta.downloadCV, href: profile.cvUrl, icon: 'fas fa-file-pdf' },
];
---

<ProfileLayout title={content.title} profile={profile} lang={lang}>
  <!-- Hero -->
  <HeroSection profile={profile} lang={lang} />
  
  <!-- Proyectos -->
  <section id="proyectos" class="py-20 bg-slate-50 dark:bg-slate-800 transition-colors">
    <div class="max-w-7xl mx-auto px-4">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold mb-4 text-slate-900 dark:text-white">{t.sections.featuredProjects}</h2>
        <p class="text-slate-600 dark:text-slate-400 max-w-2xl mx-auto">
          {content.projectsDescription}
        </p>
      </div>
      
      <div class="grid md:grid-cols-2 gap-8">
        {projects.map((project) => (
          <ProjectCard 
            project={project} 
            profileId="developer"
            lang={lang}
          />
        ))}
      </div>
    </div>
  </section>
  
  <!-- Skills -->
  <SkillsSection profile={profile} lang={lang} />
  
  <!-- Experiencia -->
  <ExperienceTimeline 
    title={t.sections.experience}
    experiences={experiences}
    profileId="developer"
  />
  
  <!-- CTA Final -->
  <CTASection
    title={content.ctaTitle}
    description={content.ctaDescription}
    buttons={ctaButtons}
    profileId="developer"
  />
</ProfileLayout>
