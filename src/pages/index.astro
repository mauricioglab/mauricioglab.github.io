---
import BaseTailwind from '../layouts/BaseTailwind.astro';

export const prerender = true;

const base = import.meta.env.BASE_URL;
const b = base.endsWith("/") ? base : `${base}/`;
const glob = import.meta.glob("./**/*.astro");
const keys = Object.keys(glob).filter((k) => 
  k !== "./index.astro" && 
  !k.startsWith("./blog/[") && 
  !k.startsWith("./blog/category/[") &&
  !k.startsWith("./[lang]/") &&
  k !== "./blog/about/index.astro" &&
  k !== "./blog/search/index.astro" &&
  k !== "./blog/archives/index.astro" &&
  k !== "./blog/privacy/index.astro"
);

function pathToRoute(key: string): { segment: string; name: string; url: string } {
    const raw = key.replace(/^\.\//, "").replace(/\.astro$/, "");
    const segment = raw.endsWith("/index") ? raw.slice(0, -6) : raw;
    const url = `${b}${segment}/`;
    const name = segment.charAt(0).toUpperCase() + segment.slice(1);
    return { segment, name, url };
}

const pages = keys.map(pathToRoute).sort((a, b) => a.segment.localeCompare(b.segment));

// i18n pages (manually added since they use [lang] dynamic routes)
const i18nPages = [
  // Landing pages
  { segment: 'es/landing/developer', name: 'Landing Developer (ES)', url: `${b}es/landing/developer/` },
  { segment: 'en/landing/developer', name: 'Landing Developer (EN)', url: `${b}en/landing/developer/` },
  { segment: 'es/landing/analista', name: 'Landing Analista (ES)', url: `${b}es/landing/analista/` },
  { segment: 'en/landing/analista', name: 'Landing Analyst (EN)', url: `${b}en/landing/analista/` },
  { segment: 'es/landing/ia-engineer', name: 'Landing IA Engineer (ES)', url: `${b}es/landing/ia-engineer/` },
  { segment: 'en/landing/ia-engineer', name: 'Landing AI Engineer (EN)', url: `${b}en/landing/ia-engineer/` },
  { segment: 'es/landing/freelance', name: 'Landing Freelance (ES)', url: `${b}es/landing/freelance/` },
  { segment: 'en/landing/freelance', name: 'Landing Freelance (EN)', url: `${b}en/landing/freelance/` },
  { segment: 'es/landing/speaker', name: 'Landing Speaker (ES)', url: `${b}es/landing/speaker/` },
  { segment: 'en/landing/speaker', name: 'Landing Speaker (EN)', url: `${b}en/landing/speaker/` },
  // Project case studies
  { segment: 'es/proyectos/ecommerce-platform', name: 'Case Study: E-commerce (ES)', url: `${b}es/proyectos/ecommerce-platform/` },
  { segment: 'en/proyectos/ecommerce-platform', name: 'Case Study: E-commerce (EN)', url: `${b}en/proyectos/ecommerce-platform/` },
  { segment: 'es/proyectos/microservicios-api', name: 'Case Study: Microservicios (ES)', url: `${b}es/proyectos/microservicios-api/` },
  { segment: 'en/proyectos/microservicios-api', name: 'Case Study: Microservices (EN)', url: `${b}en/proyectos/microservicios-api/` },
  { segment: 'es/proyectos/task-manager-ddd', name: 'Case Study: Task Manager DDD (ES)', url: `${b}es/proyectos/task-manager-ddd/` },
  { segment: 'en/proyectos/task-manager-ddd', name: 'Case Study: Task Manager DDD (EN)', url: `${b}en/proyectos/task-manager-ddd/` },
];

const allPages = [...pages, ...i18nPages];
---

<BaseTailwind title="MG Lab" description="Herramientas">
	<main class="min-h-[calc(100vh-112px)] flex bg-white">        
        <div class="w-1/2 flex items-start justify-center py-8 overflow-y-auto">
            <div class="w-full max-w-lg px-8">
                <table class="w-full">
                    <tbody>
                        {allPages.map((p) => (
                            <tr class="border-b border-stone-200 hover:bg-stone-50 transition-colors duration-300">
                                <td class="py-3 px-4 text-stone-700 font-light text-sm">
                                    {p.name}
                                </td>
                                <td class="py-3 px-4 text-right">
                                    <a 
                                        href={p.url}
                                        class="text-stone-500 hover:text-stone-900 transition-colors duration-300 text-sm"
                                    >
                                        Ir â†’
                                    </a>
                                </td>
                            </tr>
                        ))}
                    </tbody>
                </table>
            </div>
        </div>
        <div class="w-px bg-stone-200 sticky top-0 h-screen"></div>
        <div class="w-1/2 flex items-center justify-center sticky top-0 h-screen">
            <div class="text-center space-y-6">
                <div class="text-8xl opacity-30">
                    
                </div>
                <p class="text-stone-500 text-lg font-light tracking-wide italic">
                    "Hola..."
                </p>
            </div>
        </div>
        
    </main>
</BaseTailwind>
